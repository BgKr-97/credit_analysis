# Описание таблицы stage

Файл schema_stg.sql содержит SQL-скрипты для создания временных таблиц в слое stage хранилища данных (DWH). Этот слой используется для первоначальной загрузки "сырых" данных, полученных от банка в формате JSON. 
Данные в этом слое не изменяются и не обогащаются — они служат промежуточным буфером перед основной обработкой.

## Таблица stg_clients
Содержит информацию о клиентах. В нее загружается содержимое файла clients.json, полученного от банка. 
  
| Поле            | Тип данных                                                                  | Ограничения    | Описание                         |
| --------------- | --------------------------------------------------------------------------- | -------------- | -------------------------------- |
| client_id       | INTEGER                                                                     | PRIMARY KEY    | Уникальный идентификатор клиента |
| gender          | ENUM('Male', 'Female')                                                      | NOT NULL       | Пол клиента                      |
| birth_date      | DATE                                                                        | NOT NULL       | Дата рождения                    |
| education       | ENUM('primary', 'higher', 'double_higher')                                  | NOT NULL       | Уровень образования              |
| children_count  | SMALLINT                                                                    | NOT NULL       | Количество детей                 |
| employment_type | ENUM('unemployed', 'entrepreneur', 'self_employed', 'employed')             | NOT NULL       | Тип занятости                    |
| region          | VARCHAR(50)                                                                 | NOT NULL       | Регион проживания                |
| mary_status     | ENUM('married', 'no_married')                                               | NOT NULL       | Семейное положение               |

Подробное описание некоторых полей:
- gender: 'Male' - мужчина, 'Female' - женщина;
- education: 'primary' - общее образование (11 классов), 'higher' - высшее образование, 'double_higher' - двойное высшее образование;
- employment_type: 'unemployed' - безработный, 'entrepreneur' - ИП, 'self_employed' - самозанятый, 'employed' - трудоустроенный по контракту (найм);
- mary_status: 'married' - в браке, 'no_married' - не в браке.


## Таблица stg_loans
Содержит информацию о кредитах. В нее загружается содержимое файла loans.json. 
Каждый кредит связан с конкретным клиентом и содержит сумму, срок в месяцах и дату, до которой кредит должен быть выплачен.

| Поле          | Тип данных       | Ограничения                                                 | Описание               |
|---------------|------------------|-------------------------------------------------------------|------------------------|
| loan_id       | INTEGER          | PRIMARY KEY                                                 | Уникальный ID кредита  |
| client_id     | INTEGER          | NOT NULL, FOREIGN KEY REFERENCES stg_clients(client_id)     | Ссылка на клиента      |
| loan_amount   | DECIMAL(12, 2)   | NOT NULL, CHECK (loan_amount > 0)                           | Сумма кредита в рублях |
| term_months   | SMALLINT         | NOT NULL, CHECK (term_months > 0)                           | Срок в месяцах         |
| due_date      | DATE             | NOT NULL                                                    | Срок возврата кредита  |



## Особенности
Таблицы в этом слое можно очищать и перезаписывать без риска потери производных данных — они служат только как точка входа данных в DWH.

В дальнейшем из этих таблиц данные поступают в слой core, где обогащаются (например, рассчитывается статус просрочки по модели рисков).


